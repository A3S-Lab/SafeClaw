.markdown {
    @apply text-[14px] leading-relaxed;

    /* ── Headings ── */
    h1 {
        @apply text-xl font-bold mt-4 mb-2;
    }
    h2 {
        @apply text-lg font-bold mt-4 mb-2;
    }
    h3 {
        @apply text-base font-semibold mt-3 mb-1.5;
    }
    h4 {
        @apply text-sm font-semibold mt-3 mb-1;
    }

    /* ── Paragraph ── */
    p {
        @apply my-1.5;
    }
    p:first-child {
        @apply mt-0;
    }
    p:last-child {
        @apply mb-0;
    }

    /* ── Strong / Emphasis ── */
    strong {
        @apply font-semibold;
    }

    /* ── Links ── */
    a {
        @apply text-primary underline underline-offset-2 decoration-primary/40 hover:decoration-primary transition-colors;
    }

    /* ── Lists ── */
    ul {
        @apply list-disc pl-5 my-1.5 space-y-0.5;
    }
    ol {
        @apply list-decimal pl-5 my-1.5 space-y-0.5;
    }
    li {
        @apply text-[14px];
    }
    li > ul,
    li > ol {
        @apply my-0.5;
    }

    /* ── Blockquote ── */
    blockquote {
        @apply border-l-2 border-primary/40 pl-3 my-2 text-muted-foreground italic;
    }

    /* ── Horizontal Rule ── */
    hr {
        @apply border-border my-3;
    }

    /* ── Table ── */
    table {
        @apply w-full my-2 text-[13px] border-collapse;
    }
    thead {
        @apply border-b;
    }
    thead th {
        @apply text-left px-3 py-1.5 font-semibold text-muted-foreground bg-muted/50 text-xs;
    }
    thead th:first-child {
        @apply rounded-tl-md;
    }
    thead th:last-child {
        @apply rounded-tr-md;
    }
    tbody tr {
        @apply border-b border-border/50 last:border-b-0;
    }
    tbody td {
        @apply px-3 py-1.5;
    }
    tbody tr:hover {
        @apply bg-muted/20;
    }

    /* ── Code blocks (fenced) ── */
    @apply [&>pre]:rounded-lg [&>pre]:border [&>pre]:bg-card [&>pre]:my-[8px];

    .shiki-header {
        @apply flex justify-between items-center py-1.5 px-3 border-b bg-muted/50 rounded-t-lg;
        .language-label {
            @apply font-medium text-xs;
        }
    }

    .shiki-code {
        .shiki {
            @apply rounded-b-lg py-2 px-3 text-[13px] leading-relaxed overflow-x-auto;
        }

        /* Dual theme support: show light in light mode, dark in dark mode */
        .shiki,
        .shiki span {
            color: var(--shiki-light);
            background-color: transparent;
        }
    }

    /* ── Inline code ── */
    :not(pre) > code {
        @apply rounded bg-muted px-1.5 py-0.5 text-[13px] font-mono;
    }

    /* ── Images ── */
    img {
        @apply rounded-md max-w-full my-2;
    }
}

/* Dark mode: switch to dark theme colors */
.dark .markdown .shiki-code {
    .shiki,
    .shiki span {
        color: var(--shiki-dark);
    }
}
